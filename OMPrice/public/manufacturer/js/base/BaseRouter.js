define("BaseRouter",["Class"],function(e){var r=e.extend({routes:{},angModule:null,$scope:null,errorPage:null,error:null,validator:function(e){e(!0)},init:function(e,r){this.angModule=e,this.scope=r},_applyListener:function(e,r,t){var o,n=r.split("/"),i=[],a="listener";t&&(a="afterChangeListener");for(var s in this.routes){for(var l=s.split("/"),u=!0,f=0,p=n.length;p>f;f++)if(l[f]&&-1!=l[f].indexOf(":"))i.push(n[f]);else if(l[f]!=n[f]){i=[],u=!1;break}if(u){o=this[this.routes[s][a]];break}}i.unshift(e),o&&o.apply(options,i)},run:function(){var e=this,r=window.location.hash,t=r.substr(r.indexOf("#")+1);this.angModule&&this.angModule.config(["$routeProvider",function(r){for(var t in e.routes){var o=e.routes[t];(o.templateUrl||o.template)&&o.controller&&r.when(t,{template:o.template,templateUrl:o.templateUrl,controller:o.controller,title:o.title})}}]);var o=function(r){r=e.$scope||r,r.$on("$locationChangeSuccess",function(t,o,n){o=o.substr(o.indexOf("#")+1),n=-1!=n.indexOf("#")?n.substr(n.indexOf("#")+1):"";var i=function(t){if(t)o&&e._applyListener(r,o),n&&e._applyListener(r,n,!0);else if(e.errorPage&&(window.location.hash=e.errorPage),e.error){if("function"!=typeof e.error)throw new Error("BaseRouter: error property must be function");e.error()}};if("function"!=typeof e.validator)throw new Error("BaseRouter: validator property must be function");e.validator(i)})};this.angModule.run(["$rootScope",function(r){o(e.$scope?e.$scope:r),e._applyListener(e.$scope||r,t)}])}});return r});