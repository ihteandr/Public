define(["jquery","lodash","BaseController","text!templates/main/pages/product-info/product-eans/template.html","text!templates/popups/create/base/template.html","Bootstrap"],function(e,t,n,s,i){var a=n.extend({_modalService:null,init:function(e,t){this._super(e),this._modalService=t},addEan:function(){var t=this;this._modalService.showModal({template:i,controller:"popupCreateBaseController",inputs:{title:"Create EAN",validator:function(e){return 13==e.length},errorMsg:"EAN must have 13 length"}}).then(function(n){e(n.element[0]).modal(),setTimeout(function(){e(n.element[0]).find("input").focus()},200),n.close.then(function(e){1==e.answer&&(t.$scope.tmpEans.push(e.name),t.$scope.tmpEan=t.$scope.tmpEans.join(","))})})},removeEan:function(n){var s=e(n.target).attr("data-ean");this.$scope.eans=t.filter(this.$scope.eans,function(e){return e!=s}),this.$scope.tmpEans=t.filter(this.$scope.tmpEans,function(e){return e!=s}),this.$scope.ean=this.$scope.eans.join(","),this.$scope.tmpEan=this.$scope.tmpEans.join(",")},defineScope:function(){this.$scope.tmpEans=this.$scope.tmpEans||[],this.$scope.addEan=this.addEan.bind(this),this.$scope.removeEan=this.removeEan.bind(this)},updateTmpEans:function(){"undefined"!=typeof this.$scope.tmpEan&&(this.$scope.tmpEans=t.difference(this.$scope.tmpEan.split(","),this.$scope.eans))},updateEans:function(){"undefined"!=typeof this.$scope.ean&&(this.$scope.eans=this.$scope.ean.split(","))},defineListeners:function(){this._super(),this.$scope.$watch("ean",this.updateEans.bind(this)),this.$scope.$watch("tmpEan",this.updateTmpEans.bind(this))},destroy:function(){}});return a.$inject=["$scope","ModalService"],function(){return{restrict:"EA",replace:!0,template:s,scope:{ean:"=",tmpEan:"="},controller:a}}});