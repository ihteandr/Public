define(["jquery","Lodash","text!templates/main/pages/product-info/product-eans/template.html","text!templates/popups/create/base/template.html","Bootstrap"],function(e,n,t,a){return function(){return{restrict:"EA",replace:!0,template:t,scope:{ean:"=",tmpEan:"=",currentEan:"="},controller:["$scope","ModalService",function(t,o){function r(){t.currentEan=n.union(t.eans,t.tmpEans).join(",")}t.eans=t.eans||[],t.tmpEans=t.tmpEans||[],t.$watch("ean",function(){t.ean&&(t.eans=t.ean.split(","),r())}),t.$watch("tmpEan",function(){t.tmpEan&&(t.tmpEans=n.difference(t.tmpEan.split(","),t.eans),r())}),t.addEAN=function(){o.showModal({template:a,controller:"baseCreateController",inputs:{title:"Create EAN",validator:function(e){return 13==e.length},errorMsg:"EAN must have 13 length"}}).then(function(n){n.element.modal(),console.log("element ",n.element),setTimeout(function(){e(n.element[0]).find("input").focus()},200),n.close.then(function(e){1==e.answer&&(t.eans.push(e.name),t.ean=t.eans.join(","))})})},t.removeEan=function(a){var o=e(a.target).attr("data-ean");t.eans=n.filter(t.eans,function(e){return e!=o}),t.ean=t.eans.join(",")}}]}}});