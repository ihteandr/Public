define(["jquery","Lodash"],function(e,t){return["$scope","HomeService","SpinService",function(n,r,a){n.productList=[],n.pages=[],n.currentPage=1;var c={offset:0,limit:24},o=function(){n.productList=[],a.startSpin(e(".home-content-container")[0]),r.getProductList(c).then(function(e){n.productList=e.products,n.total=e.total,n.regeneratePages(),a.stopSpin()},App.errorHandler)},u=function(e,t){void 0!=e[t]?c[t]=e[t]:delete c[t]},i=function(){1==n.currentPage?o():n.currentPage=1};n.$watch("currentPage",function(e,t){e!=t&&(c.offset=25*(n.currentPage-1),o())}),n.$on("marketSelected",function(e,t){u(t,"market"),i()}),n.$on("sectionSelected",function(e,t){u(t,"section"),i()}),n.$on("categorySelected",function(e,t){u(t,"category"),i()}),n.$on("familySelected",function(e,t){u(t,"family"),i()}),n.$on("countrySelected",function(e,t){u(t,"country"),i()}),n.$on("brandSelected",function(e,t){u(t,"brand"),i()}),n.regeneratePages=function(){var r=[],a=Math.ceil(n.total/25),c=n.currentPage-5>1?n.currentPage-5:1;1!=c&&r.push(1),n.currentPage>6&&r.push("..");for(var o=c;a>o&&10>=o-c;o++)r.push(o);var u=t.filter(r,function(e){return!isNaN(e)});u.push(1),Math.max.apply(Math,u)<a&&r.push("..."),r.push(a),n.pages=r,1==n.currentPage&&e("li[name=prevPageLink]").addClass("disabled"),n.currentPage==a&&e("li[name=nextPageLink]").addClass("disabled")},n.prevPage=function(e){e?n.currentPage-=5:n.currentPage>1&&n.currentPage--},n.nextPage=function(e){e?n.currentPage+=5:n.currentPage<n.total/25&&n.currentPage++},n.goPage=function(t){var r=e(t.target).attr("data-page");n.currentPage=parseInt(r)}}]});